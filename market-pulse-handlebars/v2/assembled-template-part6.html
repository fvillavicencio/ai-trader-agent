        {{#if fundamentalMetrics.magnificentSeven}}
          <div class="subsection">
            <h3>Magnificent Seven</h3>
            <div class="stocks-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px 28px; align-items: stretch;">
              {{#each fundamentalMetrics.magnificentSeven}}
                <div class="stock-card" style="border-radius: 6px; overflow: hidden; box-shadow: none; width: 100%; height: 100%; border: 1px solid {{#if (gt priceChange 0)}}#4CAF50{{else}}#f44336{{/if}}; display: flex; flex-direction: column;">
                  <div style="display: flex; justify-content: space-between; align-items: flex-start; padding: 18px; background-color: #f8f9fa;">
                    <!-- Left: Symbol and Company Name -->
                    <div style="display: flex; flex-direction: column; align-items: flex-start; min-width: 120px;">
                      <div style="font-weight: bold; font-size: clamp(1.2rem, 3vw, 1.2rem); color: #000; letter-spacing: 1px;">{{symbol}}</div>
                      <div style="font-size: clamp(0.8rem, 2vw, 0.9rem); font-style: italic; color: #555; font-weight: normal; margin-top: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 120px;">{{name}}</div>
                    </div>
                    <!-- Right: Price, Arrow, Price Change, Percent Change (single line) -->
                    <div style="display: flex; flex-direction: column; align-items: flex-end; min-width: 110px;">
                      <div style="font-weight: bold; font-size: clamp(1rem, 3vw, 1.15rem); color: {{#if (gt priceChange 0)}}#4CAF50{{else}}#f44336{{/if}}; margin-bottom: 2px; white-space: nowrap;">${{price}} <span style="color: {{#if (gt priceChange 0)}}#4CAF50{{else}}#f44336{{/if}};">{{#if (gt priceChange 0)}}&#8593;{{else}}&#8595;{{/if}}</span> <span style="color: {{#if (gt priceChange 0)}}#4CAF50{{else}}#f44336{{/if}}; font-weight: normal;">{{priceChange}}</span> <span style="color: {{#if (gt priceChange 0)}}#4CAF50{{else}}#f44336{{/if}}; font-weight: normal;">({{percentChange}}%)</span></div>
                    </div>
                  </div>
                  <!-- Metrics Table -->
                  <div style="padding: 10px 12px 8px 12px; background-color: white; flex: 1 1 auto;">
                    <table style="width: 100%; border-collapse: collapse; font-size: clamp(0.95rem, 2vw, 1.05rem); border: none;">
                      <tbody>
                        {{#each metrics}}
                          <tr>
                            <td style="color: #777; padding: 4px 8px 4px 0; border: none;">{{name}}</td>
                            <td style="font-weight: bold; color: #222; padding: 4px 0; text-align: right; border: none;">{{value}}</td>
                          </tr>
                        {{/each}}
                      </tbody>
                    </table>
                  </div>
                </div>
              {{/each}}
            </div>
          </div>
        {{/if}}
        
        {{#if fundamentalMetrics.otherStocks}}
          <div class="subsection">
            <h3>Other Stocks</h3>
            <div class="stocks-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px 28px; align-items: stretch;">
              {{#each fundamentalMetrics.otherStocks}}
                <div class="stock-card" style="border-radius: 6px; overflow: hidden; box-shadow: none; width: 100%; height: 100%; border: 1px solid {{#if (gt priceChange 0)}}#4CAF50{{else}}#f44336{{/if}}; display: flex; flex-direction: column;">
                  <div style="display: flex; justify-content: space-between; align-items: flex-start; padding: 18px; background-color: #f8f9fa;">
                    <!-- Left: Symbol and Company Name -->
                    <div style="display: flex; flex-direction: column; align-items: flex-start; min-width: 120px;">
                      <div style="font-weight: bold; font-size: clamp(1.2rem, 3vw, 1.2rem); color: #000; letter-spacing: 1px;">{{symbol}}</div>
                      <div style="font-size: clamp(0.8rem, 2vw, 0.9rem); font-style: italic; color: #555; font-weight: normal; margin-top: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 120px;">{{name}}</div>
                    </div>
                    <!-- Right: Price, Arrow, Price Change, Percent Change (single line) -->
                    <div style="display: flex; flex-direction: column; align-items: flex-end; min-width: 110px;">
                      <div style="font-weight: bold; font-size: clamp(1rem, 3vw, 1.15rem); color: {{#if (gt priceChange 0)}}#4CAF50{{else}}#f44336{{/if}}; margin-bottom: 2px; white-space: nowrap;">${{price}} <span style="color: {{#if (gt priceChange 0)}}#4CAF50{{else}}#f44336{{/if}};">{{#if (gt priceChange 0)}}&#8593;{{else}}&#8595;{{/if}}</span> <span style="color: {{#if (gt priceChange 0)}}#4CAF50{{else}}#f44336{{/if}}; font-weight: normal;">{{priceChange}}</span> <span style="color: {{#if (gt priceChange 0)}}#4CAF50{{else}}#f44336{{/if}}; font-weight: normal;">({{percentChange}}%)</span></div>
                    </div>
                  </div>
                  <!-- Metrics Table -->
                  <div style="padding: 10px 12px 8px 12px; background-color: white; flex: 1 1 auto;">
                    <table style="width: 100%; border-collapse: collapse; font-size: clamp(0.95rem, 2vw, 1.05rem); border: none;">
                      <tbody>
                        {{#each metrics}}
                          <tr>
                            <td style="color: #777; padding: 4px 8px 4px 0; border: none;">{{name}}</td>
                            <td style="font-weight: bold; color: #222; padding: 4px 0; text-align: right; border: none;">{{value}}</td>
                          </tr>
                        {{/each}}
                      </tbody>
                    </table>
                  </div>
                </div>
              {{/each}}
            </div>
          </div>
        {{/if}}
      </div>
    {{/if}}
    
    <!-- Macroeconomic Factors Section -->
    {{#if macroeconomicFactors}}
      <div class="section" style="background-color: white; border-radius: 8px; padding: 28px 32px; margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
        <h2 style="color: #333; border-bottom: 1px solid #eee; padding-bottom: 10px; margin-top: 0; text-align: center;">Macroeconomic Factors</h2>
        
        <!-- Treasury Yields -->
        {{#if macroeconomicFactors.treasuryYields}}
          <style>
            @media (max-width: 600px) {
              .yield-separator { display: none !important; }
              .yields-row { flex-direction: column !important; }
              .yields-cell { min-width: 100% !important; border-right: none !important; }
            }
            @media (min-width: 601px) {
              .yields-row { flex-direction: row !important; }
              .yields-cell { min-width: 90px !important; }
            }
          </style>
        
          <div style="margin-bottom: 20px;">
            <div style="font-weight: bold; margin-bottom: 10px; font-size: clamp(1.1rem, 3vw, 1.25rem);">Treasury Yields</div>
            <div class="yields-row" style="display: flex; flex-wrap: wrap; background-color: #f8f9fa; padding: 15px; border-radius: 6px; margin-bottom: 10px;">
              {{#each macroeconomicFactors.treasuryYields.yields}}
                <div class="yields-cell" style="flex: 1 1 90px; min-width: 90px; max-width: 100%; text-align: center; padding: 0 10px; position: relative; box-sizing: border-box;">
                  <div style="color: #666; font-size: clamp(0.95rem, 2vw, 1.05rem); margin-bottom: 8px;">{{maturity}}</div>
                  <div style="color: #4CAF50; font-weight: bold; font-size: clamp(1.1rem, 2.5vw, 1.25rem);">
                    {{rate}}%
                  </div>
                  {{#unless @last}}
                    <div class="yield-separator" style="position: absolute; top: 10%; right: 0; bottom: 10%; width: 3px; background-color: #4CAF50; border-radius: 2px;"></div>
                  {{/unless}}
                </div>
              {{/each}}
            </div>

            <div style="margin-top: 15px; padding-left: 15px; border-left: 4px solid {{macroeconomicFactors.treasuryYields.yieldCurve.color}};">
              <div style="font-weight: bold; font-size: clamp(1rem, 3vw, 1.25rem);; margin-bottom: 5px;">Yield Curve: {{macroeconomicFactors.treasuryYields.yieldCurve.status}}</div>
              <div style="color: #555; font-size: clamp(1rem, 3vw, 1.25rem);;">{{macroeconomicFactors.treasuryYields.yieldCurve.description}}</div>
            </div>
            <div style="font-size: 10px; color: #888; margin-top: 10px; text-align: right;">
              Source: <a href="{{macroeconomicFactors.treasuryYields.sourceUrl}}">{{macroeconomicFactors.treasuryYields.source}}</a>, as of {{macroeconomicFactors.treasuryYields.asOf}}
            </div>
          </div>
        {{/if}}
